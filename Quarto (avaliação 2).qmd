---
title: "Guilherme Burgarelli"
format:
  html:
    theme: darkly
editor: visual
---

```{r}
#| label: load-packages
#| include: false

library(GetBCBData)
library(tidyverse)
library(gganimate)
library(transformr)

```


```{r}
#| label: animated-ipca
#| warning: false
#| echo: false

# Obter a série do BCB
meu.id <- c(divida = 17414)

df.bcb <- gbcbd_get_series(id = meu.id,
                           first.date = '2000-01-01',
                           last.date = Sys.Date(),
                           format.data = 'long',
                           use.memoise = TRUE,
                           cache.path = tempdir(),
                           do.parallel = FALSE)

# Gráfico animado com gganimate
grafico_divida <- ggplot(df.bcb, aes(x = ref.date, y = value)) +
  geom_line(color = "darkgreen") +
  geom_point(color = "white", size = 2) +
  labs(
    title = 'Data: {frame_time}',
    subtitle = 'Série histórica (código 17414) - Banco Central do Brasil',
    x = 'Data', y = 'Valor (%)'
  ) +
  theme_minimal(base_family = "sans") +
  theme(
    plot.background = element_rect(fill = "black", color = NA),
    panel.background = element_rect(fill = "black", color = NA),
    panel.grid.major = element_line(color = "#444444"),
    panel.grid.minor = element_line(color = "#333333"),
    plot.title = element_text(hjust = 0.5, color = "white", size = 14),
    axis.title = element_text(color = "white"),
    axis.text = element_text(color = "white")
  ) +
  transition_time(ref.date) +
  ease_aes('linear')

# Exibir animação
animate(grafico_divida, width = 800, height = 600, fps = 20)

# (Opcional) salvar o gif
# anim_save("divida_animado.gif")

```
